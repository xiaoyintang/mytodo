# Week View 实现规范（Claude Code 执行文档）

> 本文档用于指导 Claude Code 在**现有 Todo 项目实现基础上**，
> 严格按照 Pencil 最新设计稿，对 **周视图（Week View）** 进行功能与交互完善。
>
> 目标：
>
> * 功能真实可用（非展示型 UI）
> * 交互与设计稿一一对应
> * 数据驱动、可维护

---

## 一、背景说明

当前 Todo 应用已具备：

* 日视图（Day View）
* 周视图（Week View）的基础布局
* 新增任务（Add Task）完整流程（含日期 / 时间 / 标签 / 优先级）
* 任务状态（todo / in_progress / completed）
* 基础任务渲染逻辑

现在需要在**不破坏既有结构**的前提下，
对 **Week View** 进行补全，使其完全符合设计稿与交互预期。

---

## 二、周视图任务卡片展示规则（Week View Task Item）

### 1. 文本展示规则

* 每个任务标题：

  * **只允许显示一行内容**
  * 不允许自动换行
* 当标题长度超出容器宽度时：

  * 使用 `text-overflow: ellipsis`
  * **最多允许在第二行出现省略号**（不允许超过两行）
* 禁止因为文字过长而撑高任务卡片高度

---

### 2. 时间展示规则（重要）

* **周视图中的任务卡片下方不展示时间**
* 开始时间 / 结束时间：

  * **仅在悬浮信息卡（Hover Card）中展示**
* 周视图任务卡片中仅保留：

  * 任务标题
  * 状态 / 标签的视觉标识（颜色、icon）

---

### 3. 排序规则

* 在 Week View 中：

  * 同一天内的任务，**按照开始时间从上到下排序**
  * 没有开始时间的任务，排在最后
* 排序必须基于真实数据字段（如 `startTime`），
  不允许依赖当前 DOM 渲染顺序

---

### 4. 滚动规则

* 当某一天的任务数量 **超出该日期列可视高度**时：

  * 该日期列内部启用 **纵向滚动**
  * 不影响整体 Week View 布局
* 滚动条样式保持克制：

  * 可使用 Tailwind 默认滚动条
  * 或细滚动条样式

---

## 三、日期列头部信息（设计对齐）

### 5. 任务统计展示

* 每个日期列顶部，必须展示：

  * **已完成任务数 / 总任务数**
* 示例格式（与设计稿一致）：

```
✔ 2 / 5
```

* 统计数据必须与任务真实状态同步更新

---

## 四、悬浮信息卡（Hover Card / Popover）

### 6. 悬浮触发方式

* 当鼠标 **hover 在周视图任务卡片上** 时显示悬浮信息卡
* 鼠标移出后自动消失
* 不需要点击触发

---

### 7. 悬浮卡展示内容（顺序必须严格一致）

悬浮卡从上到下依次展示：

1. **任务标题**（完整显示，不截断）
2. **任务状态**（todo / in_progress / completed）
3. **任务标签 / 优先级**（如：高优、工作、学习）
4. **日期**（示例：2026年2月1日 周日）
5. **时间范围**（示例：10:30 - 11:30）

   * 若任务未设置时间，则不显示该行

---

### 8. 悬浮卡视觉规范

* 悬浮卡需具备：

  * 圆角
  * 阴影
  * 高于主视图的层级（避免被遮挡）
* 宽度自适应内容，但需设置合理最大宽度，避免过宽

---

## 五、交互补充（基于既有逻辑）

### 9. 状态切换逻辑

* 单击任务：

  * todo → in_progress
* 双击任务：

  * in_progress → completed
* 视觉优先级规则：

  * completed 状态覆盖所有标签显示
  * in_progress 状态覆盖优先级 / 标签

---

## 六、实现约束（必须遵守）

* ❌ 不允许仅实现 UI 外观
* ✅ 所有内容必须来自真实 state / 数据模型
* ❌ 不允许写死文案或 mock 数据
* ✅ 排序、统计、悬浮内容必须数据驱动

---

## 七、最终验收标准

当我在 Week View 中进行以下操作时：

* 创建任务
* 设置时间 / 标签 / 优先级
* 切换任务状态
* 悬浮查看任务详情

系统必须保证：

* 周视图展示与设计稿一致
* 数据实时同步
* 无文本溢出或布局破坏

---

> 本文档即为 Claude Code 的执行规范，
> 请在当前项目实现基础上严格遵循。
