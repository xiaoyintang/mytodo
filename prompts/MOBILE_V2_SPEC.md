# 📱 Todo App Mobile 交互实现规范（最终版）

> **适用对象：Claude Code（工程实现）**  
> **设计来源：Pencil 中当前选中的 Frame**  
> **注意：这是“增量修改规范”，不是重做说明**

---

## 一、⚠️ 强制约束（非常重要）

### ❗ 必须遵守

1. **禁止重做 UI**
2. **禁止新增设计稿中未出现的交互**
3. **禁止调整整体布局结构**
4. **禁止自行合并 / 简化交互逻辑**
5. **只允许在「Pencil 当前选中的 Frame」基础上做修改**

> 如果某个行为在设计稿中已经存在，只允许**补齐逻辑**，不允许替换交互方式。

---

## 二、全局交互原则（所有视图通用）

1. **一个操作只做一件事**
2. **状态切换、编辑、删除必须完全解耦**
3. **不使用 hover / 长按预览（移动端）**
4. **重操作（编辑 / 删除）集中到底部弹窗（Bottom Sheet）**
5. **轻操作（状态切换）直接在列表中完成**

---

## 三、任务状态逻辑（全局统一）

### 3.1 状态定义

任务状态顺序固定为：

```
待办 → 进行中 → 已完成 → 待办

```

### 3.2 状态切换方式

- **点击任务主体区域**（不包含按钮 / 图标）  
→ 按上述顺序循环切换状态

### 3.3 禁止行为

- 编辑过程中不得改变状态
- 删除前不得自动修改状态
- 不允许存在第二种状态切换入口

---

## 四、📅 Mobile 周视图（Week View）实现规范

> 对应 Pencil 中：
>
> - `Mobile Week V2 - Bottom Sheet`
> - `Mobile Week V3 - Delete Confirm`

### 4.1 列表态行为

- 点击任务 → 打开 Bottom Sheet
- 周视图中 **不直接切换状态**
- 周视图中 **不提供编辑按钮**

### 4.2 Bottom Sheet 内容结构（从上到下）

1. 任务标题（完整显示，不截断）
2. 当前状态标识（进行中 / 已完成 / 待办）
3. 【状态切换按钮】
  - 文案根据当前状态变化
  - 示例：
    - “标记为进行中”
    - “标记为已完成”
4. 标签 / 优先级
5. 日期
6. 时间范围
7. 【删除按钮】

### 4.3 编辑规则（周视图）

- **点击标题文字进入编辑状态**
- 修改完成后：
  - 点击空白处 / 关闭 Bottom Sheet 即保存
- 不单独提供“编辑按钮”

### 4.4 删除规则

- 点击删除 → 弹出确认弹窗
- 确认后永久删除
- 不可撤销

---

## 五、📆 Mobile 日视图（Day View V3 – Final）实现规范

> 对应 Pencil 中：
>
> - `Mobile Day View V3 - With Actions`

### 5.1 单条任务结构

每一行任务右侧必须包含：

- ✏️ 编辑图标
- 🗑️ 删除图标

### 5.2 点击行为定义（严格区分）


| 点击区域     | 行为      |
| -------- | ------- |
| 任务主体     | 切换状态    |
| ✏️ 编辑图标  | 进入编辑模式  |
| 🗑️ 删除图标 | 删除（需确认） |


> **点击图标不得触发状态切换**

### 5.3 文本与布局规则

- 标题：**单行显示**
- 超出长度：使用省略号
- 时间：显示在标题下方
- 标题允许比周视图更长

---

## 六、✏️ 编辑行为统一规范

### 6.1 编辑方式

- 点击进入可编辑状态
- 文本直接可修改
- 无单独“保存”按钮

### 6.2 保存规则

- 点击其他区域
- 或关闭 Bottom Sheet  
→ 自动保存

### 6.3 编辑过程中

- 不触发状态变化
- 不触发删除

---

## 七、❌ 明确移除的交互（禁止实现）

以下交互 **已明确废弃**，不得出现：

- 长按悬浮预览卡
- Hover 预览
- 多入口编辑
- 状态切换 + 编辑混合手势

---

## 八、⏱ 时间切换按钮（Day / Week 共用）

### 8.1 `<` / `>` 按钮行为

- 点击 `<`：切换到上一周（周一 → 周日）
- 点击 `>`：切换到下一周（周一 → 周日）

### 8.2 联动规则

- 顶部日期文本随之更新
- 日期选择条同步刷新
- 当前选中日期保持在对应周内

---

## 九、完成标准（Definition of Done）

以下条件全部满足，才算完成：

- 行为与 Pencil 设计稿完全一致
- 不存在冲突点击逻辑
- 所有状态变化路径唯一
- 编辑 / 删除不会误触状态
- 未引入任何设计稿之外的新交互

---

## 十、再次强调（给 Claude Code）

> **这是在现有实现上的精修，不是重写。**  
> **只根据我当前在 Pencil 中选中的 Frame 修改对应逻辑。**

